---
layout: default
title: Plugin Android project
description: "Create a job test with pandalab"
permalink: /create-test
nav_order: 2
---
# Configure Android project

The PandaLab gradle plugin makes it easy to create test tasks. It is possible to create several gradle tasks if you have very specific needs.

## Configuration

Add the gradle plugin classpath to the build.gradle file at the root of the project:  

```groovy
buildscript {
    ext.pandalab_version = '1.0.0-SNAPSHOT'
    dependencies {
        classpath "com.leroymerlin.pandalab:gradle-plugin:$pandalab_version"
    }
}
```

Then modify the build.gradle file of your application module for configure the PandaLab plugin :

```groovy
apply plugin: 'com.android.application'

// add this line to apply the pandalab plugin
apply plugin: 'com.leroymerlin.pandalab'

pandalab {
    serviceAccountFile = file("YOUR FIREBASE ADMIN SDK .JSON")
    appName = "APP NAME"
    apiUrl = "YOUR FIREBASE REST API URL"
}
```


To know how to recover the file please consult the following link : [documentation](https://firebase.google.com/docs/admin/setup)

## Create a task

A PandaLab task allows you to define the various parameters in order to launch your instrumentation tests on a phone fleet. You can define the variant name, the device lists, the device groups on which the tests will be run.

```groovy
pandalab {
    // ...
    tests {
        test1 {
            variantName = "debug"
            devices = ["345678765433456", "09876543456789098765"]
            groups = ["pandalab"]
            timeoutInSecond = 1800
            waitForResult = false
            enable = true
        }
        test2 {
            variantName = "debug"
            devices = ["345678765433456", "09876543456789098765"]
            groups = ["pandalab2"]
            timeoutInSecond = 1100
            waitForResult = true
            enable = false
        }
    }
}
```
<div class="code-example" markdown="1">
* **variantName**: name of the variant to retrieve the apk that will be launched for the tests
* **devices**: the identifiers of the devices on which the tests will be run. The identifiers correspond to the identifiers generated by Firestore.
* **groups**: the name of the groups on which the tests will be run.
* **timeoutInSecond**: timeout in second. The default value is _900 seconds_.
* **waitForResult**: wait for the result on all tests launched. Very useful for fail a CI job. The default value is _true_.
* **enable**: Enable a task. The default value is true.
</div>

The different tests declared in `tests` generate a task gradle with the name of the test with the suffix `PandaLabTest`.

In the example above, it generates the tasks : `test1PandaLabTest` and `test2PandaLabTest`

#### Run one task
For launch the previously created task `test1` launch the command line : 

```bash
./gradlew app:test1PandaLabTest
```


#### Run all tasks

```bash
./gradlew runPandaLabTests
```
